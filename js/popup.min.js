!function(){let e=document.querySelector(".popup__date-wrap"),t=e.querySelector("#date-min"),n=e.querySelector("#date-max"),a=e.querySelector(".date-cover-min"),l=e.querySelector(".date-cover-max"),r=function(e=1){return new Date(Date.now()+24*e*60*60*1e3).toLocaleDateString()},o=function(e){let t=e.split(".");return`${t[2]}-${t[1]}-${t[0]}`};t.value=o(r()),t.setAttribute("min",t.value),a.textContent=new Date(t.value).toLocaleDateString(),n.value=o(r(2)),n.setAttribute("min",n.value),l.textContent=new Date(n.value).toLocaleDateString(),t.addEventListener("input",(function(){Date.parse(t.value)>=Date.parse(n.value)&&(n.value=o(new Date(Date.parse(t.value)+864e5).toLocaleDateString())),n.min=o(new Date(Date.parse(t.value)+864e5).toLocaleDateString()),l.textContent=new Date(n.value).toLocaleDateString(),a.textContent=new Date(t.value).toLocaleDateString()})),n.addEventListener("input",(function(){t.max=o(new Date(Date.parse(n.value)-864e5).toLocaleDateString()),l.textContent=new Date(n.value).toLocaleDateString(),a.textContent=new Date(t.value).toLocaleDateString()}))}(),function(){let e=document.querySelector("body"),t=document.querySelector(".room__to-book"),n=document.querySelector(".popup"),a=document.querySelector(".popup-wrap"),l=n.querySelector(".popup__booking"),r=n.querySelector(".popup__feedback"),o=l.querySelector(".popup-close-button"),u=window.innerWidth-document.querySelector("html").clientWidth,i=function(){document.querySelector("html").style.paddingRight=u+"px"},s=function(){document.querySelector("html").removeAttribute("style")},c=function(){s(),e.classList.remove("body-lock"),l.classList.remove("popup-inner-animation"),n.classList.remove("popup-animation"),setTimeout((function(){n.classList.add("popup--close"),r.classList.remove("visually-hidden")}),300),document.removeEventListener("keydown",d)},d=function(e){27==e.keyCode&&c()};o.addEventListener("click",c),o.addEventListener("keyDown",(function(e){13==e.keyCode&&c()})),a.addEventListener("click",(function(e){e.target==a&&c()}));let g=function(){r.classList.add("visually-hidden"),e.classList.add("body-lock"),n.classList.remove("popup--close"),setTimeout((function(){l.classList.add("popup-inner-animation"),n.classList.add("popup-animation")}),50),document.addEventListener("keydown",d),i()};t.addEventListener("click",g),t.addEventListener("keydown",(function(e){13==e.keyCode&&g()}));let p=r.querySelector(".popup-close-button"),v=r.querySelector(".button-done"),m=function(){s(),e.classList.remove("body-lock"),r.classList.remove("popup-inner-animation"),n.classList.remove("popup-animation"),setTimeout((function(){n.classList.add("popup--close"),l.classList.remove("visually-hidden")}),300)};p.addEventListener("click",m),v.addEventListener("click",m),a.addEventListener("click",(function(e){e.target==a&&m()})),document.addEventListener("DOMContentLoaded",(function(){let t=document.querySelector(".popup__form"),a=t.querySelector('input[name="client-name"]'),o=t.querySelector('input[name="cat-name"]'),u=t.querySelector('input[type="tel"]'),s=t.querySelector('input[type="email"]'),d=t.querySelector(".popup__submit"),g={"client-name":!1,"cat-name":!1,"client-phone":!1,"client-email":!1},p=function(){g["client-name"]&&g["cat-name"]&&g["client-phone"]&&g["client-email"]?d.removeAttribute("disabled","disabled"):d.setAttribute("disabled","disabled")};p(),a.selectionStart=a.value.length,o.selectionStart=o.value.length,u.selectionStart=u.value.length;let v=document.createDocumentFragment(),m=document.createElement("p"),y=document.createElement("span"),h=function(e){m.classList.add("popup__error-message"),m.innerHTML=e,m.appendChild(y),v.appendChild(m)},f=[],w=function(e){let n=t.querySelector(".popup__error-message");n&&(n.dataset.name!=e.target.name&&f.push({name:n.dataset.name,text:n.innerHTML}),n.remove()),e.target.style.borderColor="transparent",e.target.style.transitionDuration="0.2s",e.target.style.boxShadow="0 0 20px 1px rgba(255, 0, 0, 0.6)",m.setAttribute("data-name",e.target.name);let a=v.cloneNode(!0);t.appendChild(a);let l=t.querySelector(".popup__error-message");l.style.top=e.target.offsetTop-parseInt(window.getComputedStyle(l).height)-25+"px",window.setTimeout((function(){l.style.opacity="1",l.style.transform="translateY(0px)"}),10)},L=function(e){f.length>0&&function(e,n){h(n),m.setAttribute("data-name",e.name);let a=v.cloneNode(!0);t.appendChild(a),window.setTimeout((function(){let n=t.querySelector(".popup__error-message");n.style.top=e.offsetTop-parseInt(window.getComputedStyle(n).height)-25+"px",n.style.opacity="1",n.style.transform="translateY(0px)"}),500);let l=f.findIndex((function(t){return t.name===e.name}));f.splice(l,1)}(t.querySelector(`input[name="${f[f.length-1].name}"]`),f[f.length-1].text),e.target.style.borderColor="",e.target.style.boxShadow="";let n=t.querySelector(".popup__error-message");console.log(n);let a=function(){e.target.style.transitionDuration="",n.remove()};n&&e.target.name==n.dataset.name&&(n.style.opacity="0",n.style.transform="translateY(-9px)",window.setTimeout(a,200))};const S=/^[а-яА-ЯёЁ]{0,16}$/;let b=function(e){let t;t&&window.clearTimeout(t),t=window.setTimeout((function(){!function(e){!S.test(e.target.value)&&e.target.value.length>0?(h("Это поле может содержать только буквы кириллицы!"),e.target.value.length>16&&h("Длинна имени не должна превышать 16 символов!"),e.target.setAttribute("maxlength","1"),w(e)):(e.target.removeAttribute("maxlength","1"),L(e),e.target.value&&(e.target.value=e.target.value[0].toUpperCase()+e.target.value.substring(1).toLowerCase())),S.test(e.target.value)&&e.target.value.length>1&&e.target.value.length<16?(g[e.target.name]=!0,p()):(g[e.target.name]=!1,p())}(e)}),100)};a.addEventListener("input",b),o.addEventListener("input",b);let T,D=function(e){S.test(e.target.value)&&e.target.value.length>0&&(T&&window.clearTimeout(T),T=window.setTimeout((function(){!function(e){0!=e.target.value.length&&e.target.value.length<2?(h("Имя не может быть короче двух букв!"),w(e)):S.test(e.target.value)&&e.target.value.length<1&&L(e)}(e)}),1e3))};a.addEventListener("input",D),o.addEventListener("input",D);let x="+7",q=" ";u.addEventListener("focus",(function(e){0==e.target.value.length&&(e.target.value=x)}));let C=12+4*q.length;u.addEventListener("blur",(function(e){e.target.value.length<=2&&(e.target.value=""),function(e){e.target.value.length<C&&(h("Введите номер телефона в формате:<br>+7 - XXX - XXX - XX - XX"),w(e))}(e)})),u.addEventListener("input",(function(e){if(isNaN(parseInt(e.data))&&"insertText"==e.inputType){let t;for(let n=0;n<e.target.value.length;n++)isNaN(parseInt(e.target.value[n]))&&(t=e.target.value.substring(0,n)+e.target.value.substring(n+1));e.target.value=t}"insertText"!=e.inputType||e.target.value.startsWith(x)||(e.target.value=x),e.target.value.length<=2&&"deleteContentBackward"==e.inputType||e.target.value.length<=2&&"deleteContentForward"==e.inputType?e.target.value=x:(e.target.value.length>2&&"deleteContentBackward"==e.inputType||e.target.value.length>2&&"deleteContentForward"==e.inputType)&&window.setTimeout((function(){0==e.target.value.length?e.target.value=x:0==e.target.value.length||e.target.value.startsWith(x)||(e.target.value=x)}),100),function(e){let t;"insertText"==e.inputType?(3==e.target.value.length||e.target.value.length==6+q.length||e.target.value.length==9+2*q.length||e.target.value.length==11+3*q.length)&&(t=e.target.value.substring(0,e.target.value.length-1)+q+e.target.value.substring(e.target.value.length-1),e.target.value=t):"deleteContentBackward"!=e.inputType&&"deleteContentForward"!=e.inputType||e.target.value.substring(e.target.value.length-q.length)==q&&(t=e.target.value.substring(0,e.target.value.length-q.length),e.target.value=t);let n=12+4*q.length;e.target.value.length==n&&(e.target.setAttribute("maxlength",n),L(e))}(e),e.target.value.length==C?g[e.target.name]=!0:g[e.target.name]=!1,p()}));let E,k,_=/.+@.+\..+/i,A=/[^а-яА-ЯёЁ]/,X=!1,N=function(e){_.test(e.target.value)||0==e.target.value?X&&(L(e),X=!1):(h("Адрес почты должен содержать символы '@' и '.'"),w(e),X=!0)};s.addEventListener("blur",N),s.addEventListener("input",(function(e){let t;if(X&&"insertText"==e.inputType&&(E&&window.clearTimeout(E),E=window.setTimeout((function(){N(e)}),500)),!A.test(e.data)){for(let n=0;n<e.target.value.length;n++)A.test(e.target.value[n])||(t=e.target.value.substring(0,n)+e.target.value.substring(n+1),h("Адрес почты не может содержать буквы кириллицы!"),w(e),k&&window.clearTimeout(k),k=window.setTimeout((function(){L(e)}),2e3));e.target.value=t}_.test(e.target.value)&&e.target.value.length>8?g[e.target.name]=!0:g[e.target.name]=!1,p()})),d.addEventListener("click",(function(a){a.preventDefault(),c(),console.log(g);for(let e in g)g[e]=!1;window.setTimeout((function(){t.reset(),l.classList.add("visually-hidden"),e.classList.add("body-lock"),n.classList.remove("popup--close"),setTimeout((function(){r.classList.add("popup-inner-animation"),n.classList.add("popup-animation")}),50),i()}),500),console.log(g),p()}))}))}();